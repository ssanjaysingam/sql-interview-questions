>>Cummulative sum:
select ids,val , sum(val) over(partition by ids order by ids rows between unbounded preceding and current row) as r_val from tables

select ids, val, sum(val) over(partition by ids order by ids rows unbouned preceding) as r_val from tables
